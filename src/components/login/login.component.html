<div class="flex items-center justify-center min-h-screen bg-gray-900">
  <div class="w-full max-w-md p-8 space-y-6 bg-gray-800 rounded-2xl shadow-lg">
    
    @switch (mode()) {
      @case ('login') {
        <div>
          <div class="text-center">
            <h1 class="text-4xl font-bold text-lime-400">GymFlow</h1>
            <p class="mt-2 text-gray-400">¡Bienvenido de nuevo, campeón!</p>
          </div>

          <form class="mt-6 space-y-6" (ngSubmit)="handleLogin()">
            @if (successMessage()) {
              <div class="p-3 text-sm text-green-300 bg-green-900/50 rounded-lg">
                {{ successMessage() }}
              </div>
            }
            <div>
              <label for="email" class="text-sm font-medium text-gray-300">Correo Electrónico</label>
              <input id="email" name="email" type="email" autocomplete="email" required
                [ngModel]="email()" (ngModelChange)="email.set($event)"
                class="w-full px-3 py-2 mt-1 text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-lime-400"
                placeholder="tu@ejemplo.com">
            </div>

            <div>
              <div class="flex justify-between items-center">
                <label for="password" class="text-sm font-medium text-gray-300">Contraseña</label>
                <button type="button" (click)="setMode('forgotPassword')" class="text-sm text-lime-400 hover:underline cursor-pointer focus:outline-none">¿Olvidaste tu contraseña?</button>
              </div>
              <input id="password" name="password" type="password" autocomplete="current-password" required
                [ngModel]="password()" (ngModelChange)="password.set($event)"
                class="w-full px-3 py-2 mt-1 text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-lime-400"
                placeholder="••••••••">
            </div>

            @if (errorMessage()) {
              <div class="p-3 text-sm text-red-300 bg-red-900/50 rounded-lg">
                {{ errorMessage() }}
              </div>
            }

            <div>
              <button type="submit" [disabled]="loading()"
                class="w-full px-4 py-3 font-semibold text-gray-900 bg-lime-400 rounded-md hover:bg-lime-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-lime-400 transition-colors duration-300 disabled:opacity-50 disabled:cursor-wait">
                @if (loading()) {
                  <span>Procesando...</span>
                } @else {
                  <span>Iniciar Sesión</span>
                }
              </button>
            </div>

            <p class="text-sm text-center text-gray-400">
              ¿No tienes una cuenta? <button type="button" (click)="setMode('register')" class="font-medium text-lime-400 hover:underline cursor-pointer focus:outline-none">Regístrate ahora</button>
            </p>
          </form>
        </div>
      }

      @case ('register') {
        <div>
          <div class="text-center">
            <h1 class="text-4xl font-bold text-lime-400">Crear Cuenta</h1>
            <p class="mt-2 text-gray-400">Únete a la comunidad GymFlow.</p>
          </div>

          <form class="mt-6 space-y-4" (ngSubmit)="handleRegister()">
             <div>
              <label for="name" class="text-sm font-medium text-gray-300">Nombre Completo</label>
              <input id="name" name="name" type="text" autocomplete="name" required
                [ngModel]="name()" (ngModelChange)="name.set($event)"
                class="w-full px-3 py-2 mt-1 text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-lime-400"
                placeholder="Tu Nombre">
            </div>
            <div>
              <label for="email" class="text-sm font-medium text-gray-300">Correo Electrónico</label>
              <input id="email" name="email" type="email" autocomplete="email" required
                [ngModel]="email()" (ngModelChange)="email.set($event)"
                class="w-full px-3 py-2 mt-1 text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-lime-400"
                placeholder="tu@ejemplo.com">
            </div>
            <div>
              <label for="password" class="text-sm font-medium text-gray-300">Contraseña</label>
              <input id="password" name="password" type="password" required
                [ngModel]="password()" (ngModelChange)="password.set($event)"
                class="w-full px-3 py-2 mt-1 text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-lime-400"
                placeholder="••••••••">
            </div>
             <div>
              <label for="confirmPassword" class="text-sm font-medium text-gray-300">Confirmar Contraseña</label>
              <input id="confirmPassword" name="confirmPassword" type="password" required
                [ngModel]="confirmPassword()" (ngModelChange)="confirmPassword.set($event)"
                class="w-full px-3 py-2 mt-1 text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-lime-400"
                placeholder="••••••••">
            </div>

            @if (errorMessage()) {
              <div class="p-3 text-sm text-red-300 bg-red-900/50 rounded-lg">
                {{ errorMessage() }}
              </div>
            }

            <div>
              <button type="submit" [disabled]="loading()"
                class="w-full mt-2 px-4 py-3 font-semibold text-gray-900 bg-lime-400 rounded-md hover:bg-lime-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-lime-400 transition-colors duration-300 disabled:opacity-50 disabled:cursor-wait">
                @if (loading()) {
                  <span>Registrando...</span>
                } @else {
                  <span>Registrarse</span>
                }
              </button>
            </div>
            <p class="text-sm text-center text-gray-400">
              ¿Ya tienes una cuenta? <button type="button" (click)="setMode('login')" class="font-medium text-lime-400 hover:underline cursor-pointer focus:outline-none">Inicia sesión</button>
            </p>
          </form>
        </div>
      }

      @case ('forgotPassword') {
        <div>
          <div class="text-center">
            <h1 class="text-3xl font-bold text-lime-400">Restablecer Contraseña</h1>
            <p class="mt-2 text-gray-400">Ingresa tu correo para recibir un enlace de recuperación.</p>
          </div>

          <form class="mt-6 space-y-6" (ngSubmit)="handleForgotPassword()">
            <div>
              <label for="email" class="text-sm font-medium text-gray-300">Correo Electrónico</label>
              <input id="email" name="email" type="email" autocomplete="email" required
                [ngModel]="email()" (ngModelChange)="email.set($event)"
                class="w-full px-3 py-2 mt-1 text-gray-100 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-lime-400"
                placeholder="tu@ejemplo.com">
            </div>
            
            @if (errorMessage()) {
              <div class="p-3 text-sm text-red-300 bg-red-900/50 rounded-lg">
                {{ errorMessage() }}
              </div>
            }

            <div>
              <button type="submit" [disabled]="loading()"
                class="w-full px-4 py-3 font-semibold text-gray-900 bg-lime-400 rounded-md hover:bg-lime-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-lime-400 transition-colors duration-300 disabled:opacity-50 disabled:cursor-wait">
                @if (loading()) {
                  <span>Enviando...</span>
                } @else {
                  <span>Enviar Enlace</span>
                }
              </button>
            </div>
            <p class="text-sm text-center text-gray-400">
              <button type="button" (click)="setMode('login')" class="font-medium text-lime-400 hover:underline cursor-pointer focus:outline-none">Volver a inicio de sesión</button>
            </p>
          </form>
        </div>
      }
    }

  </div>
</div>
